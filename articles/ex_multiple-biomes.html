<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="hector">
<title>Running Hector with multiple biomes • hector</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Running Hector with multiple biomes">
<meta property="og:description" content="hector">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hector</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/manual.html">Manual</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-getting-started">Getting Started</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-getting-started">
    <a class="dropdown-item" href="../articles/BuildHector.html">Building Hector</a>
    <a class="dropdown-item" href="../articles/hector.html">Intro to Hector R interface</a>
    <a class="dropdown-item" href="../articles/Hector-Wider-World.html">Documentation manuscripts &amp; tutorials</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/hector.html">Example: Basic run and simple sensitivity anlaysis</a>
    <a class="dropdown-item" href="../articles/ex_hector_apply.html">Example: Using Hector to solve for an emissions pathway</a>
    <a class="dropdown-item" href="../articles/ex_multiple-biomes.html">Example: Running Hector with multiple biomes</a>
    <a class="dropdown-item" href="../articles/ex_carbon_tracking.html">Example: Carbon tracking with Hector</a>
    <a class="dropdown-item" href="../articles/ex_land_ocean_warming.html">Example: Changing Hector's land ocean warming ratio parameter</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JGCRI/hector">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Running Hector with multiple biomes</h1>
            <h3 data-toc-skip class="subtitle">R</h3>
                        <h4 data-toc-skip class="author">Alexey
Shiklomanov</h4>
            
            <h4 data-toc-skip class="date">2019-06-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JGCRI/hector/blob/HEAD/vignettes/articles/ex_multiple-biomes.Rmd" class="external-link"><code>vignettes/articles/ex_multiple-biomes.Rmd</code></a></small>
      <div class="d-none name"><code>ex_multiple-biomes.Rmd</code></div>
    </div>

    
    
<p>By default, Hector’s carbon cycle model treats the entire land
surface as a single, homogeneous ecosystem. However, it is possible to
introduce some land surface heterogeneity by splitting the land surface
into several different biomes with distinct parameters. In this
vignette, we show two examples of performing multi-biome analyses with
Hector.</p>
<p>This vignette assumes some familiarity with the Hector model and its
R interface. For help on the former, consult the <a href="manual/index.html">Hector manual</a>, and on the latter, see the
<a href="intro-to-hector.html">introductory vignette</a>.</p>
<p>Before we begin, let’s load the R package we will need: the
<code>hector</code> package to interact with Hector, and the
<code>ggplot2</code> package for plotting.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JGCRI/hector" class="external-link">hector</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-1-accelerated-high-latitude-warming">Example 1: Accelerated high-latitude warming<a class="anchor" aria-label="anchor" href="#example-1-accelerated-high-latitude-warming"></a>
</h2>
<p>Observational and modeling studies have found that high-latitude
ecosystems, particularly in the Northern Hemisphere, are warming
significantly faster than the global average. In this example, we will
explore the implications of this effect with Hector.</p>
<p>First, let’s run a reference case.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssp245</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input"</span>, <span class="st">"hector_ssp245.ini"</span>, package <span class="op">=</span> <span class="st">"hector"</span><span class="op">)</span></span>
<span><span class="va">core</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newcore.html">newcore</a></span><span class="op">(</span><span class="va">ssp245</span>, suppresslogging <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/carboncycle.html">CONCENTRATIONS_CO2</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/forcings.html">RF_TOTAL</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/temperature.html">GLOBAL_TAS</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">reference_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>, <span class="va">result_vars</span>, scenario <span class="op">=</span> <span class="st">"reference"</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s redo the run, but accounting for accelerated high-latitude
warming. To do this, we will use the <code><a href="../reference/split_biome.html">split_biome()</a></code>
function, which takes an existing Hector biome and splits it up into an
arbitrary number of new biomes, partitioning the C pools and
initializing parameters accordingly. For the purposes of this example,
let’s assume that high latitudes have ~10% of the world’s vegetation and
detritus carbon and ~40% of world’s soil carbon, and that high-latitudes
are warming 2.5x faster than the global average.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/split_biome.html">split_biome</a></span><span class="op">(</span><span class="va">core</span>, <span class="st">"global"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low-latitude"</span>, <span class="st">"high-latitude"</span><span class="op">)</span>,</span>
<span>            fveg_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>            fdetritus_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>            fsoil_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>            warmingfactor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/reset.html">reset</a></span><span class="op">(</span><span class="va">core</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-resetting core to -1</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">warming_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>, <span class="va">result_vars</span>, scenario <span class="op">=</span> <span class="st">"warming"</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s plot the results.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">reference_results</span>, <span class="va">warming_results</span><span class="op">)</span></span>
<span><span class="va">plot_data</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">variable</span>, <span class="va">result_vars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ex_multiple-biomes_files/figure-html/warming-plot-1.png" alt="Hector results with vs. without accelerated high-latitude warming." width="700"><p class="caption">
Hector results with vs. without accelerated high-latitude warming.
</p>
</div>
<p>The results show that accelerated high-latitude warming induces a
positive global feedback in Hector: the warmer high-latitudes respire
carbon from soil and detritus at a faster rate, which leads to higher
CO<sub>2</sub> concentrations and further warming.</p>
<p>We can look at these results in more detail by examining the
biome-specific pools and fluxes via the optional <code>biome</code>
argument to Hector’s identifier functions
(e.g. <code><a href="../reference/carboncycle.html">VEG_C()</a></code>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">warming_details</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="st">"low-latitude"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="st">"high-latitude"</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="st">"low-latitude"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="st">"high-latitude"</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="st">"low-latitude"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="st">"high-latitude"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             scenario <span class="op">=</span> <span class="st">"warming"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">warming_details</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   scenario year           variable    value units</span></span>
<span><span class="co">## 1  warming 2000 low-latitude.veg_c 505.9479  Pg C</span></span>
<span><span class="co">## 2  warming 2001 low-latitude.veg_c 506.2329  Pg C</span></span>
<span><span class="co">## 3  warming 2002 low-latitude.veg_c 506.5745  Pg C</span></span>
<span><span class="co">## 4  warming 2003 low-latitude.veg_c 506.9243  Pg C</span></span>
<span><span class="co">## 5  warming 2004 low-latitude.veg_c 507.3095  Pg C</span></span>
<span><span class="co">## 6  warming 2005 low-latitude.veg_c 507.6409  Pg C</span></span></code></pre>
<p>For plotting, let’s split up the <code>variable</code> column into
its components – <code>biome</code> and <code>variable</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variable_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">warming_details</span><span class="op">$</span><span class="va">variable</span>, <span class="st">"."</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">warming_details</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">variable_split</span>, <span class="st">"[["</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low-latitude"</span>, <span class="st">"high-latitude"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">warming_details</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">variable_split</span>, <span class="st">"[["</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">warming_details</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">biome</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ex_multiple-biomes_files/figure-html/warming-details-plot-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="example-2-c3-and-c4-plants">Example 2: C3 and C4 plants<a class="anchor" aria-label="anchor" href="#example-2-c3-and-c4-plants"></a>
</h2>
<p>We can conduct a similar experiment to the one above by looking at
the differential impact of CO<sub>2</sub> fertilization on C3 and C4
plants. Specifically, C4 plants possess a special mechanism for
concentrating CO<sub>2</sub> inside their leaves, thereby reducing their
sensitivity to changes in atmospheric CO<sub>2</sub>. Although this
makes C4 plants more efficient (particularly in hot and dry
environments), this also means that they should have a reduced
CO<sub>2</sub> fertilization effect compared to C3 plants.</p>
<p>In Hector, the CO<sub>2</sub> fertilization effect is controlled by
the parameter <span class="math inline">\(\beta\)</span>
(<code><a href="../reference/parameters.html">BETA()</a></code>). In this example, we will create two “biomes,”
corresponding to C3 and C4 plants, each with different
<code><a href="../reference/parameters.html">BETA()</a></code> values, and will compare model outputs from this
special case against a reference case (which we can recycle from the
<code>reference_results</code> object in the previous example). For the
purposes of this example, we will assume that ~10% of the world’s
terrestrial carbon is associated with C4 plants, and that the
CO<sub>2</sub> fertilization effect for C4 plans is half as strong as
that of C3 plants.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">core</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newcore.html">newcore</a></span><span class="op">(</span><span class="va">ssp245</span>, suppresslogging <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/split_biome.html">split_biome</a></span><span class="op">(</span><span class="va">core</span>, <span class="st">"global"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C3"</span>, <span class="st">"C4"</span><span class="op">)</span>,</span>
<span>            fveg_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>            beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.36</span>, <span class="fl">0.18</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/reset.html">reset</a></span><span class="op">(</span><span class="va">core</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Auto-resetting core to -1</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c4_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>, <span class="va">result_vars</span>, scenario <span class="op">=</span> <span class="st">"c3 vs c4"</span><span class="op">)</span></span>
<span><span class="va">c4_results_biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="st">"C3"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="st">"C4"</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="st">"C3"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="st">"C4"</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="st">"C3"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="st">"C4"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              scenario <span class="op">=</span> <span class="st">"c3 vs c4"</span><span class="op">)</span></span>
<span><span class="va">variable_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">c4_results_biome</span><span class="op">$</span><span class="va">variable</span>, <span class="st">"."</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">c4_results_biome</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">variable_split</span>, <span class="st">"[["</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">c4_results_biome</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">variable_split</span>, <span class="st">"[["</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c4_results</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="st">"global"</span></span>
<span><span class="va">reference_results</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="st">"global"</span></span>
<span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">reference_results</span>, <span class="va">c4_results</span>, <span class="va">c4_results_biome</span><span class="op">)</span></span>
<span><span class="va">plot_data</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">variable</span>, <span class="va">result_vars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, linetype <span class="op">=</span> <span class="va">scenario</span>, color <span class="op">=</span> <span class="va">biome</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ex_multiple-biomes_files/figure-html/fert-c4-1.png" width="700"></p>
<p>Similarly to accounting for high-latitude warming, accounting for the
reduced CO<sub>2</sub> fertilization effect on C4 plants results in a
slightly warmer and CO<sub>2</sub>-rich atmosphere.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kalyn Dorheim, Ben Bond-Lamberty.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
