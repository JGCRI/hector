<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running Hector with multiple biomes • hector</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Running Hector with multiple biomes">
<meta property="og:description" content="hector">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hector</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/manual/index.html">Manual</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-to-hector.html">A tour of the Hector R interface</a>
    </li>
    <li>
      <a href="../articles/hector_apply.html">Example: Using Hector to solve for an emissions pathway</a>
    </li>
    <li>
      <a href="../articles/multiple-biomes.html">Example: Running Hector with multiple biomes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JGCRI/hector" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="multiple-biomes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Running Hector with multiple biomes</h1>
                        <h4 data-toc-skip class="author">Alexey Shiklomanov</h4>
            
            <h4 data-toc-skip class="date">2019-06-27</h4>
      
      
      <div class="hidden name"><code>multiple-biomes.Rmd</code></div>

    </div>

    
    
<p>By default, Hector’s carbon cycle model treats the entire land surface as a single, homogeneous ecosystem. However, it is possible to introduce some land surface heterogeneity by splitting the land surface into several different biomes with distinct parameters. In this vignette, we show two examples of performing multi-biome analyses with Hector.</p>
<p>This vignette assumes some familiarity with the Hector model and its R interface. For help on the former, consult the <a href="manual/index.html">Hector manual</a>, and on the latter, see the <a href="intro-to-hector.html">introductory vignette</a>.</p>
<p>Before we begin, let’s load the R package we will need: the <code>hector</code> package to interact with Hector, and the <code>ggplot2</code> package for plotting.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">hector</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-1-accelerated-high-latitude-warming">Example 1: Accelerated high-latitude warming<a class="anchor" aria-label="anchor" href="#example-1-accelerated-high-latitude-warming"></a>
</h2>
<p>Observational and modeling studies have found that high-latitude ecosystems, particularly in the northern hemisphere, are warming significantly faster than the global average. In this example, we will explore the implications of this effect with Hector.</p>
<p>First, let’s run a reference case.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rcp45</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input"</span>, <span class="st">"hector_rcp45.ini"</span>, package <span class="op">=</span> <span class="st">"hector"</span><span class="op">)</span></span>
<span><span class="va">core</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newcore.html">newcore</a></span><span class="op">(</span><span class="va">rcp45</span>, suppresslogging <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/carboncycle.html">ATMOSPHERIC_CO2</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/forcings.html">RF_TOTAL</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/temperature.html">GLOBAL_TEMP</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">reference_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>, <span class="va">result_vars</span>, scenario <span class="op">=</span> <span class="st">"reference"</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s redo the run, but accounting for accelerated high-latitude warming. To do this, we will use the <code><a href="../reference/split_biome.html">split_biome()</a></code> function, which takes an existing Hector biome and splits it up into an arbitrary number of new biomes, partitioning the C pools and initializing parameters accordingly. For the purposes of this example, let’s assume that high latitudes have ~10% of the world’s vegetation and detritus carbon and ~40% of world’s soil carbon, and that high-latitudes are warming 2.5x faster than the global average.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/reset.html">reset</a></span><span class="op">(</span><span class="va">core</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/split_biome.html">split_biome</a></span><span class="op">(</span><span class="va">core</span>, <span class="st">"global"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low-latitude"</span>, <span class="st">"high-latitude"</span><span class="op">)</span>,</span>
<span>            fveg_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>            fdetritus_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>            fsoil_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>            warmingfactor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">warming_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>, <span class="va">result_vars</span>, scenario <span class="op">=</span> <span class="st">"warming"</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s plot the results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">reference_results</span>, <span class="va">warming_results</span><span class="op">)</span></span>
<span><span class="va">plot_data</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">variable</span>, <span class="va">result_vars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="multiple-biomes_files/figure-html/warming-plot-1.png" alt="Hector results with vs. without accelerated high-latitude warming." width="700"><p class="caption">
Hector results with vs. without accelerated high-latitude warming.
</p>
</div>
<p>The results show that accelerated high-latitude warming induces a positive global feedback in Hector: the warmer high-latitudes respire carbon from soil and detritus at a faster rate, which leads to higher CO<sub>2</sub> concentrations and further warming.</p>
<p>We can look at these results in more detail by examining the biome-specific pools and fluxes via the optional <code>biome</code> argument to Hector’s identifier functions (e.g. <code><a href="../reference/carboncycle.html">VEG_C()</a></code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">warming_details</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="st">"low-latitude"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="st">"high-latitude"</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="st">"low-latitude"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="st">"high-latitude"</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="st">"low-latitude"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="st">"high-latitude"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             scenario <span class="op">=</span> <span class="st">"warming"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">warming_details</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   scenario year           variable    value units</span></span>
<span><span class="co">## 1  warming 2000 low-latitude.veg_c 474.8797  Pg C</span></span>
<span><span class="co">## 2  warming 2001 low-latitude.veg_c 475.3750  Pg C</span></span>
<span><span class="co">## 3  warming 2002 low-latitude.veg_c 475.8733  Pg C</span></span>
<span><span class="co">## 4  warming 2003 low-latitude.veg_c 476.3748  Pg C</span></span>
<span><span class="co">## 5  warming 2004 low-latitude.veg_c 476.8836  Pg C</span></span>
<span><span class="co">## 6  warming 2005 low-latitude.veg_c 477.4029  Pg C</span></span></code></pre>
<p>For plotting, let’s split up the <code>variable</code> column into its components – <code>biome</code> and <code>variable</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variable_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">warming_details</span><span class="op">$</span><span class="va">variable</span>, <span class="st">"."</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">warming_details</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">variable_split</span>, <span class="st">"[["</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low-latitude"</span>, <span class="st">"high-latitude"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">warming_details</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">variable_split</span>, <span class="st">"[["</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">warming_details</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">biome</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-biomes_files/figure-html/warming-details-plot-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="example-2-c3-and-c4-plants">Example 2: C3 and C4 plants<a class="anchor" aria-label="anchor" href="#example-2-c3-and-c4-plants"></a>
</h2>
<p>We can conduct a similar experiment to the one above by looking at the differential impact of CO<sub>2</sub> fertilization on C3 and C4 plants. Specifically, C4 plants possess a special mechanism for concentrating CO<sub>2</sub> inside their leaves, thereby reducing their sensitivity to changes in atmospheric CO<sub>2</sub>. Although this makes C4 plants more efficient (particularly in hot and dry environments), this also means that they should have a reduced CO<sub>2</sub> fertilization effect compared to C3 plants.</p>
<p>In Hector, the CO<sub>2</sub> fertilization effect is controlled by the parameter <span class="math inline">\(\beta\)</span> (<code><a href="../reference/parameters.html">BETA()</a></code>). In this example, we will create two “biomes,” corresponding to C3 and C4 plants, each with different <code><a href="../reference/parameters.html">BETA()</a></code> values, and will compare model outputs from this special case against a reference case (which we can recycle from the <code>reference_results</code> object in the previous example). For the purposes of this example, we will assume that ~10% of the world’s terrestrial carbon is associated with C4 plants, and that the CO<sub>2</sub> fertilization effect for C4 plans is half as strong as that of C3 plants.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">core</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/newcore.html">newcore</a></span><span class="op">(</span><span class="va">rcp45</span>, suppresslogging <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/split_biome.html">split_biome</a></span><span class="op">(</span><span class="va">core</span>, <span class="st">"global"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C3"</span>, <span class="st">"C4"</span><span class="op">)</span>,</span>
<span>            fveg_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>            beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.36</span>, <span class="fl">0.18</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">c4_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>, <span class="va">result_vars</span>, scenario <span class="op">=</span> <span class="st">"c3 vs c4"</span><span class="op">)</span></span>
<span><span class="va">c4_results_biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchvars.html">fetchvars</a></span><span class="op">(</span><span class="va">core</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2100</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="st">"C3"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">VEG_C</a></span><span class="op">(</span><span class="st">"C4"</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="st">"C3"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">DETRITUS_C</a></span><span class="op">(</span><span class="st">"C4"</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="st">"C3"</span><span class="op">)</span>, <span class="fu"><a href="../reference/carboncycle.html">SOIL_C</a></span><span class="op">(</span><span class="st">"C4"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              scenario <span class="op">=</span> <span class="st">"c3 vs c4"</span><span class="op">)</span></span>
<span><span class="va">variable_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">c4_results_biome</span><span class="op">$</span><span class="va">variable</span>, <span class="st">"."</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">c4_results_biome</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">variable_split</span>, <span class="st">"[["</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">c4_results_biome</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">variable_split</span>, <span class="st">"[["</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c4_results</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="st">"global"</span></span>
<span><span class="va">reference_results</span><span class="op">$</span><span class="va">biome</span> <span class="op">&lt;-</span> <span class="st">"global"</span></span>
<span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">reference_results</span>, <span class="va">c4_results</span>, <span class="va">c4_results_biome</span><span class="op">)</span></span>
<span><span class="va">plot_data</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">variable</span>, <span class="va">result_vars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, linetype <span class="op">=</span> <span class="va">scenario</span>, color <span class="op">=</span> <span class="va">biome</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="multiple-biomes_files/figure-html/fert-c4-1.png" width="700"></p>
<p>Similarly to accounting for high-latitude warming, accounting for the reduced CO<sub>2</sub> fertilization effect on C4 plants results in a slightly warmer and CO<sub>2</sub>-rich atmosphere.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robert Link, Kalyn Dorheim.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
