<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Terrestrial C cycle • hector</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Terrestrial C cycle">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hector</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/manual.html">Manual</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-getting-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Getting Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-getting-started">
<li><a class="dropdown-item" href="../articles/BuildHector.html">Building Hector</a></li>
    <li><a class="dropdown-item" href="../articles/hector.html">Intro to Hector R interface</a></li>
    <li><a class="dropdown-item" href="../articles/Hector-Wider-World.html">Documentation manuscripts &amp; tutorials</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/hector.html">Example: Basic run and simple sensitivity anlaysis</a></li>
    <li><a class="dropdown-item" href="../articles/ex_hector_apply.html">Example: Using Hector to solve for an emissions pathway</a></li>
    <li><a class="dropdown-item" href="../articles/ex_multiple-biomes.html">Example: Running Hector with multiple biomes</a></li>
    <li><a class="dropdown-item" href="../articles/ex_carbon_tracking.html">Example: Carbon tracking with Hector</a></li>
    <li><a class="dropdown-item" href="../articles/ex_land_ocean_warming.html">Example: Changing Hector's land ocean warming ratio parameter</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JGCRI/hector"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Terrestrial C cycle</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JGCRI/hector/blob/main/vignettes/articles/SimpleNBox.Rmd" class="external-link"><code>vignettes/articles/SimpleNBox.Rmd</code></a></small>
      <div class="d-none name"><code>SimpleNBox.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="science">Science<a class="anchor" aria-label="anchor" href="#science"></a>
</h2>
<p>Hector’s land system is divided into three pools: vegetation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>v</mi></msub><annotation encoding="application/x-tex">C_v</annotation></semantics></math>),
detritus
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>d</mi></msub><annotation encoding="application/x-tex">C_d</annotation></semantics></math>),
and soil
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>s</mi></msub><annotation encoding="application/x-tex">C_s</annotation></semantics></math>);
a fourth pool, earth
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>e</mi></msub><mi>a</mi><mi>r</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">C_earth</annotation></semantics></math>)
is used only for anthropogenic emissions and uptake. These pools are
global by default, but they can be divided into
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
“biomes” with unique parameters and initial pool sizes.</p>
<p>The total C flux from atmosphere to land at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>L</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_{L}(t)</annotation></semantics></math>;
also known as Net Biome Production, NBP) is the net of C sequestration
by photosynthesis (net primary productivity,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>P</mi><msub><mi>P</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">NPP_i(t)</annotation></semantics></math>)
and C release by heterotrophic respiration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>H</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">RH_i(t)</annotation></semantics></math>)
summed across each biome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and global land use change
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>U</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">LUC(t)</annotation></semantics></math>)
(note that this calculation does not currently include fire, another
important land C source):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>L</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mi>P</mi><msub><mi>P</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>R</mi><msub><mi>H</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>L</mi><mi>U</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> F_{L}(t) = \sum_{i=1}^{n} \left( NPP_i(t) - RH_i(t) \right) - LUC(t)  </annotation></semantics></math></p>
<p>NPP is calculated as the product of a user-specified pre-industrial
value
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>P</mi><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">NPP_0</annotation></semantics></math>,
default is 56.2 Pg C/year), a CO<sub>2</sub> fertilization multiplier
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mrow><mi>a</mi><mi>t</mi><mi>m</mi></mrow></msub><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(C_{atm}, \beta)</annotation></semantics></math>),
and the effect of land use change (LUC) on vegetation carbon stocks:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>P</mi><msub><mi>P</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>N</mi><mi>P</mi><msub><mi>P</mi><mrow><mn>0</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>×</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mrow><mi>a</mi><mi>t</mi><mi>m</mi></mrow></msub><mo>,</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><mi>U</mi><msub><mi>C</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> NPP_i(t) = NPP_{0,i} \times f(C_{atm}, \beta_i) \times f(LUC_{v}) </annotation></semantics></math></p>
<p>The CO<sub>2</sub> fertilization multiplier is a function of the
current atmospheric CO<sub>2</sub> concentration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>a</mi><mi>t</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">C_{atm}</annotation></semantics></math>),
the initial (“pre-industrial”) CO<sub>2</sub> concentration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>0</mn></msub><annotation encoding="application/x-tex">C_0</annotation></semantics></math>),
and biome-specific CO<sub>2</sub> fertilization parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\beta_i</annotation></semantics></math>
(default = 0.36):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mrow><mi>a</mi><mi>t</mi><mi>m</mi></mrow></msub><mo>,</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>+</mo><msub><mi>β</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>C</mi><mrow><mi>a</mi><mi>t</mi><mi>m</mi></mrow></msub><msub><mi>C</mi><mn>0</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> f(C_{atm}, \beta_i) = 1 + \beta_i \left( \log(\frac{C_{atm}}{C_0})\right) </annotation></semantics></math></p>
<p>The LUC multiplier accounts for the effect of vegetation losses or
gains on NPP (although we recognize that LUC does not always result in
‘lost’ NPP); this behavior is new as of Hector v3. It is computed as a
fraction based on preindustrial (end-of-spinup) vegetation carbon
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>v</mi></msub><annotation encoding="application/x-tex">C_{v}</annotation></semantics></math>)
and the running sum of LUC-driven losses from – or gains to –
vegetation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><mi>U</mi><msub><mi>C</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>C</mi><mrow><mn>0</mn><mi>v</mi></mrow></msub><mo>−</mo><mo>∑</mo><mi>L</mi><mi>U</mi><msub><mi>C</mi><mrow><mi>v</mi><mi>e</mi><mi>g</mi></mrow></msub></mrow><msub><mi>C</mi><mrow><mn>0</mn><mi>v</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex"> f(LUC_{v}) = \frac{C_{0v} - \sum LUC_{veg}}{C_{0v}} </annotation></semantics></math></p>
<p>Heterotrophic respiration occurs in soil
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>H</mi><mi>s</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">RH_s(t)</annotation></semantics></math>)
and detritus
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>H</mi><mi>d</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">RH_d(t))</annotation></semantics></math>)
as a function of biome-specific atmospheric temperature anomaly
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>,
calculated as the global atmospheric temperature anomaly scaled by a
biome-specific warming factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>)
and the size of the current soil and detritus C pools
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>s</mi></msub><annotation encoding="application/x-tex">C_s</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>d</mi></msub><annotation encoding="application/x-tex">C_d</annotation></semantics></math>,
respectively).</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>δ</mi><mspace width="0.167em"></mspace><msub><mi>T</mi><mi>G</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> T_i(t) = \delta \, T_G(t) </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>H</mi><mi>s</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>50</mn></mfrac><msub><mi>C</mi><mi>s</mi></msub><msubsup><mi>Q</mi><mn>10</mn><mrow><msub><mi>T</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>10</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex"> RH_s = \frac{1}{50} C_s Q_{10}^{T_{i}(t) / 10}</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>H</mi><mi>d</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><msub><mi>C</mi><mi>d</mi></msub><msubsup><mi>Q</mi><mn>10</mn><mrow><msub><mi>T</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>10</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex"> RH_d = \frac{1}{4} C_d Q_{10}^{T_{i}(t) / 10}</annotation></semantics></math></p>
<p>Note that the residence times of soil and detritus C pools – 50 and 4
years, respectively – are currently hard-coded values in Hector.</p>
<p>Fluxes associated with land use change
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>U</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">LUC</annotation></semantics></math>)
are prescribed via the <code>luc_emissions</code> variable in the INI
file. Example time series associated with shared socioeconomic pathways
(SSPs) are included with Hector in the corresponding
<code>inst/input/tables/ssp**_emiss-constraints_rf.csv</code> files.
There are two LUC fluxes, land uptake and loss, and both add or remove
carbon to the land pools in proportion to those pools’ size. (This
behavior is new as of version 3 of the model.) Note that the cumulative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>U</mi><msub><mi>C</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">LUC_{v}</annotation></semantics></math>,
LUC effects on vegetation, affects NPP as documented above.</p>
<p>In each biome at each time step, the vegetation pools change as
follows (biome,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and time,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
subscripts omitted for clarity): C gain from NPP is distributed to
vegetation, detritus, and soil according to fraction parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>n</mi><mi>v</mi></mrow></msub><annotation encoding="application/x-tex">f_{nv}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>n</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">f_{nd}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>n</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">f_{ns}</annotation></semantics></math>,
respectively. Similarly, each pool bears a fraction of the total C loss
from land-use change
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>L</mi><mi>C</mi></mrow></msub><annotation encoding="application/x-tex">F_{LC}</annotation></semantics></math>),
again according to fractions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>l</mi><mi>v</mi></mrow></msub><annotation encoding="application/x-tex">f_{lv}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>l</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">f_{ld}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>l</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">f_{ls}</annotation></semantics></math>.
The detritus and soil pools also lose C via heterotrophic respiration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>H</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">RH_d</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><msub><mi>H</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">RH_s</annotation></semantics></math>,
respectively). Finally, a fixed fraction of vegetation C is transferred
to detritus as litterfall
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>v</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">f_{vd}</annotation></semantics></math>),
and a fraction of both vegetation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>v</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">f_{vs}</annotation></semantics></math>)
and detritus
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mrow><mi>d</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">f_{ds}</annotation></semantics></math>)
C are transferred to soil.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>C</mi><mi>v</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>N</mi><mi>P</mi><mi>P</mi><mspace width="0.167em"></mspace><msub><mi>f</mi><mrow><mi>n</mi><mi>v</mi></mrow></msub><mo>−</mo><msub><mi>C</mi><mi>v</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>f</mi><mrow><mi>v</mi><mi>d</mi></mrow></msub><mo>+</mo><msub><mi>f</mi><mrow><mi>v</mi><mi>s</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>F</mi><mrow><mi>L</mi><mi>C</mi></mrow></msub><msub><mi>f</mi><mrow><mi>l</mi><mi>v</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> \frac{dC_v}{dt} = NPP\, f_{nv} - C_v (f_{vd} + f_{vs}) - F_{LC} f_{lv} </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>C</mi><mi>d</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>N</mi><mi>P</mi><mi>P</mi><mspace width="0.167em"></mspace><msub><mi>f</mi><mrow><mi>n</mi><mi>d</mi></mrow></msub><mo>+</mo><msub><mi>C</mi><mi>v</mi></msub><msub><mi>f</mi><mrow><mi>v</mi><mi>d</mi></mrow></msub><mo>−</mo><msub><mi>C</mi><mi>d</mi></msub><msub><mi>f</mi><mrow><mi>d</mi><mi>s</mi></mrow></msub><mo>−</mo><mi>R</mi><msub><mi>H</mi><mi>d</mi></msub><mo>−</mo><msub><mi>F</mi><mrow><mi>L</mi><mi>C</mi></mrow></msub><msub><mi>f</mi><mrow><mi>l</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> \frac{dC_d}{dt} = NPP\, f_{nd} + C_v f_{vd} - C_d f_{ds} - RH_d - F_{LC} f_{ld} </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>C</mi><mi>s</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>N</mi><mi>P</mi><mi>P</mi><mspace width="0.167em"></mspace><msub><mi>f</mi><mrow><mi>n</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mi>C</mi><mi>v</mi></msub><msub><mi>f</mi><mrow><mi>v</mi><mi>s</mi></mrow></msub><mo>−</mo><msub><mi>C</mi><mi>d</mi></msub><msub><mi>f</mi><mrow><mi>d</mi><mi>s</mi></mrow></msub><mo>−</mo><mi>R</mi><msub><mi>H</mi><mi>s</mi></msub><mo>−</mo><msub><mi>F</mi><mrow><mi>L</mi><mi>C</mi></mrow></msub><msub><mi>f</mi><mrow><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> \frac{dC_s}{dt} = NPP\, f_{ns} + C_v f_{vs} - C_d f_{ds} - RH_s - F_{LC} f_{ls} </annotation></semantics></math></p>
<p>Anthropogenic changes to the earth system are driven by fossil fuel
and industrial emissions (FFI) as well as, in some scenarios, direct air
carbon capture and storage (DACCS). These fluxes are occur out of, or
into, an ‘earth’ pool that is used for mass-balance checks:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>C</mi><mrow><mi>e</mi><mi>a</mi><mi>r</mi><mi>t</mi><mi>h</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>D</mi><mi>A</mi><mi>C</mi><mi>C</mi><mi>S</mi><mo>−</mo><mi>F</mi><mi>F</mi><mi>I</mi></mrow><annotation encoding="application/x-tex"> \frac{dC_{earth}}{dt} = DACCS - FFI</annotation></semantics></math></p>
<p>Finally, the atmosphere changes as a result of all the fluxes into or
out of it: anthropogenic emissions and uptake; land use change emissions
and uptake; fluxes into or out of the ocean; and heterotrophic
respiration and net primary production.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>C</mi><mrow><mi>a</mi><mi>t</mi><mi>m</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>F</mi><mi>F</mi><mi>I</mi><mo>−</mo><mi>D</mi><mi>A</mi><mi>C</mi><mi>C</mi><mi>S</mi><mo>+</mo><mi>L</mi><mi>U</mi><msub><mi>C</mi><mi>e</mi></msub><mo>−</mo><mi>L</mi><mi>U</mi><msub><mi>C</mi><mi>u</mi></msub><mo>+</mo><msub><mi>O</mi><mi>i</mi></msub><mo>−</mo><msub><mi>O</mi><mi>u</mi></msub><mo>+</mo><mi>R</mi><mi>H</mi><mo>−</mo><mi>N</mi><mi>P</mi><mi>P</mi></mrow><annotation encoding="application/x-tex"> \frac{dC_{atm}}{dt} = FFI - DACCS + LUC_{e} - LUC_{u} + O_{i} - O_{u} + RH - NPP </annotation></semantics></math></p>
<p>The entire terrestrial C cycle is summarized in the following
diagram:</p>
<div class="float">
<img src="hector_terrestrial_c.svg" alt="Summary of terrestrial C cycle in Hector. The full Hector C cycle also includes ocean and “Earth” C pools that exchange C with the atmosphere, but these are omitted for clarity."><div class="figcaption">Summary of terrestrial C cycle in Hector. The
full Hector C cycle also includes ocean and “Earth” C pools that
exchange C with the atmosphere, but these are omitted for clarity.</div>
</div>
</div>
<div class="section level2">
<h2 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a>
</h2>
<p>The state of the global C cycle in Hector is defined by a length 6
vector <code>c</code>, which describes the amount of C (in Pg C) in the
atmosphere (0), vegetation (1), detritus (2), soil (3), ocean (4), and
“Earth” (5) at the current time step. At each Hector time step,
<code>c</code> is solved by the <code>CarbonCycleSolver::run()</code>
function (defined in <a href="https://github.com/JGCRI/hector/blob/main/src/carbon-cycle-solver.cpp" class="external-link"><code>src/carbon-cycle-solver.cpp</code></a>)
in the following general steps:</p>
<ol style="list-style-type: decimal">
<li>Retrieve the current estimates of various pools from variables
defined by the C cycle model and assign them to the relevant parts of
<code>c</code> (<code>getCValues</code>).</li>
<li>Integrate from the beginning of the time step using updated slow
parameters (<code>slowparameval</code>).</li>
<li>Solve the ordinary differential equations associated with the C
cycle model based on its time derivatives (defined in
<code>calcderivs</code>).</li>
<li>Re-calculate C cycle model internal variables based on the solved
values of <code>c</code> (<code>stashCValues</code>).</li>
<li>Record the model state (<code>record_state</code>).</li>
</ol>
<p>These steps are described in more detail below. The complete code for
the terrestrial C cycle lives in <a href="https://github.com/jgcri/hector/blob/main/src/simpleNbox.cpp" class="external-link"><code>src/simpleNbox.cpp</code></a>
file (with associated headers in <a href="https://github.com/JGCRI/hector/blob/main/inst/include/simpleNbox.hpp" class="external-link"><code>inst/include/simpleNbox.hpp</code></a>).</p>
</div>
<div class="section level2">
<h2 id="setting-the-c-vector-getcvalues">Setting the <code>c</code> vector (<code>getCValues</code>)<a class="anchor" aria-label="anchor" href="#setting-the-c-vector-getcvalues"></a>
</h2>
<p>This function sets the values of the <code>c</code> vector to the
corresponding state variables in the C cycle model.</p>
<ul>
<li><p>The atmospheric C pool for the current time step is defined by
<code>atmos_co2</code>, which is always a scalar unit quantity (because
CO<sub>2</sub> is assumed to be well-mixed in the atmosphere).</p></li>
<li><p>Vegetation, detritus, and soil pools at the current time step are
stored in <code>veg_c</code>, <code>detritus_c</code>, and
<code>soil_c</code>, respectively. These are vector quantities
(“stringmaps”), with one value for each biome (the default biome name is
“global”), so the value stored in the corresponding slot in
<code>c</code> is the sum across all biomes. The ocean C pool is
retrieved by a call to the current ocean model’s <code>getCValues</code>
function. (NOTE: This means that <code>simpleNBox</code> model depends
on the existence of an ocean C cycle model.)</p></li>
<li><p>Finally, the “Earth” C pool is stored in <code>earth_c</code>,
which is also a scalar unit quantity.</p></li>
</ul>
<p>All of these variables have are in units Pg C.</p>
</div>
<div class="section level2">
<h2 id="slow-parameter-evaluation-slowparameval">Slow parameter evaluation (<code>slowparameval</code>)<a class="anchor" aria-label="anchor" href="#slow-parameter-evaluation-slowparameval"></a>
</h2>
<ul>
<li><p>Perform the ocean C model’s slow parameter evaluation
(<code>omodel-&gt;slowparameval</code>)</p></li>
<li>
<p>Calculate CO<sub>2</sub> fertilization effect for each biome
(<code>co2fert[biome]</code>) using the function
<code>calc_co2fert</code></p>
<ul>
<li>…unless you are in the spin-up phase, in which case assume no effect
(<code>co2fert = 1</code>)</li>
</ul>
</li>
<li>
<p>Calculate temperature effect on respiration of detritus
(<code>tempfertd</code>) and soil (<code>tempferts</code>).</p>
<ul>
<li>Note that soil warming is “sticky” – it can only increase, not
decline (even if the temperature declines between time steps)</li>
<li>Note also that while detritus warming is based on the actual current
biome temperature, the soil warming is based on a 200-year running
mean</li>
</ul>
</li>
</ul>
<p>Note that these effect parameters are calculated but not yet applied.
They will be applied to the actual NPP and RH estimates during the ODE
solving loop.</p>
</div>
<div class="section level2">
<h2 id="c-cycle-derivatives-calcderivs">C cycle derivatives (<code>calcderivs</code>)<a class="anchor" aria-label="anchor" href="#c-cycle-derivatives-calcderivs"></a>
</h2>
<ul>
<li>Calculate NPP for each biome (<code>npp</code> function)</li>
<li>Partition NPP C gain into vegetation, detritus, and soil pools
according to fractions</li>
<li>Calculate RH for detritus and soil</li>
<li>Partition C losses from RH according to fractions</li>
<li>Calculate and partition litter flux</li>
<li>Store changes in pools in <code>dcdt</code> vector (same structure
as <code>c</code>)</li>
</ul>
</div>
<div class="section level2">
<h2 id="storing-the-results-stashcvalues">Storing the results (<code>stashCValues</code>)<a class="anchor" aria-label="anchor" href="#storing-the-results-stashcvalues"></a>
</h2>
<ul>
<li>Reset the atmospheric CO<sub>2</sub> state variable
(<code>atmos_co2</code>) to the current value from <code>c</code>
</li>
<li>Calculate the difference between vegetation, detritus, and soil C
calculated by the ODE solver (i.e. in <code>c</code>) and what was
stored in the current state variables (<code>veg_c</code>,
<code>detritus_c</code>, <code>soil_c</code>). Store these differences
in <code>veg_delta</code>, <code>det_delta</code>,
<code>soil_delta</code>.</li>
<li>Apply these additional fluxes to each biome, weighing by the biome’s
current gross primary productivity (<code>NPP + RH</code>). I.e.:
<ul>
<li>Calculate the total GPP across all biomes
(<code>npp_rh_total = sum_npp() + sum_rh()</code>)</li>
<li>Calculate each biome’s weight
(<code>wt[biome] = (npp(biome) + rh(biome)) / npp_rh_total</code>)</li>
<li>Add the corresponding difference multiplied by the weight to the
biome’s current pool
(e.g. <code>veg_c[biome] = veg_c[biome] + veg_delta * wt[biome]</code>)</li>
<li>NOTE: This is a workaround. In the future, Hector will use the ODE
solver to separately solve all of the boxes in the multi-biome
system.</li>
</ul>
</li>
<li>Stash the ocean C pools using the
<code>omodel-&gt;stashCValues</code> function</li>
<li>Stash the Earth C pool (<code>earth_c</code>)</li>
<li>Check for mass conservation by take the sum of <code>c</code> (total
C in system) and comparing it against the sum from the previous timestep
(<code>masstot</code>).
<ul>
<li>NOTE: This check is skipped the first time this function is
evaluated, at which point <code>masstot</code> is initialized to the
calculated sum.</li>
</ul>
</li>
<li>If Hector is running under atmospheric CO<sub>2</sub> constraint,
re-calculate the atmospheric CO<sub>2</sub> pool to match the constraint
and move any residual C to/from the deep ocean pool.</li>
</ul>
</div>
<div class="section level2">
<h2 id="recording-the-state-record_state">Recording the state (<code>record_state</code>)<a class="anchor" aria-label="anchor" href="#recording-the-state-record_state"></a>
</h2>
<p>This just sets the time-series versions of all of the C cycle state
variables (e.g. <code>atmos_c_ts</code>, <code>veg_c_tv</code>,
<code>detritus_c_tv</code>, <code>tempfertd_tv</code>) to their
corresponding state variables at the current time step
(e.g. <code>atmos_c</code>, <code>veg_c</code>, <code>detritus_c</code>,
<code>tempfertd</code>).</p>
</div>
<div class="section level2">
<h2 id="simplenbox-setdata">Setting (<code>setData</code>) and retrieving (<code>getData</code>)
values<a class="anchor" aria-label="anchor" href="#simplenbox-setdata"></a>
</h2>
<p>The following values related to the terrestrial C cycle can be set
via <code>setData</code>.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="23%">
<col width="7%">
<col width="18%">
<col width="14%">
<col width="11%">
<col width="7%">
<col width="10%">
<col width="3%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th>Description</th>
<th>Unit</th>
<th>C++ macro</th>
<th>R function</th>
<th>C++ variable</th>
<th>Needs date</th>
<th>Biome-specific</th>
<th>Set</th>
<th>Get</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Initial atmospheric CO<sub>2</sub> pool</td>
<td>PgC</td>
<td><code>D_ATMOSPHERIC_CO2</code></td>
<td><code><a href="../reference/carboncycle.html">ATMOSPHERIC_CO2()</a></code></td>
<td><code>C0</code></td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Pre-industrial CO<sub>2</sub> concentration</td>
<td>ppmv CO<sub>2</sub>
</td>
<td><code>D_PREINDUSTRIAL_C02</code></td>
<td><code><a href="../reference/parameters.html">PREINDUSTRIAL_CO2()</a></code></td>
<td><code>C0</code></td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Atmospheric C constraint residual</td>
<td>ppmv CO<sub>2</sub>
</td>
<td><code>D_ATMOSPHERIC_C_RESIDUAL</code></td>
<td></td>
<td><code>residual</code></td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Vegetation C pool</td>
<td>PgC</td>
<td><code>D_VEGC</code></td>
<td></td>
<td><code>veg_c</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Detritus C pool</td>
<td>PgC</td>
<td><code>D_DETRITUSC</code></td>
<td></td>
<td><code>detritus_c</code></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Soil C pool</td>
<td>PgC</td>
<td><code>D_SOILC</code></td>
<td></td>
<td><code>soil_c</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Radiative forcing from albedo</td>
<td>unitless</td>
<td><code>D_RF_ALBEDO</code></td>
<td><code><a href="../reference/forcings.html">RF_ALBEDO()</a></code></td>
<td><code>RF_albedo</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Frac. NPP to vegetation</td>
<td>unitless</td>
<td><code>D_F_NPPV</code></td>
<td><code><a href="../reference/parameters.html">F_NPPV()</a></code></td>
<td><code>f_nppv</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Frac. NPP to detritus</td>
<td>unitless</td>
<td><code>D_F_NPPD</code></td>
<td><code><a href="../reference/parameters.html">F_NPPD()</a></code></td>
<td><code>f_nppd</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Frac. veg. C to litter</td>
<td>unitless</td>
<td><code>D_F_LITTERD</code></td>
<td><code><a href="../reference/parameters.html">F_LITTERD()</a></code></td>
<td><code>f_litterd</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Initial NPP flux</td>
<td>PgC / year</td>
<td><code>D_NPP_FLUX0</code></td>
<td></td>
<td><code>npp_flux0</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Fossil fuel CO<sub>2</sub> emissions</td>
<td>PgC / year</td>
<td><code>D_FFI_EMISSIONS</code></td>
<td><code><a href="../reference/carboncycle.html">FFI_EMISSIONS()</a></code></td>
<td><code>ffiEmissions</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Direct air carbon capture and storage</td>
<td>PgC / year</td>
<td><code>D_DACCS_UPTAKE</code></td>
<td><code><a href="../reference/carboncycle.html">DACCS_UPTAKE()</a></code></td>
<td><code>daccsUptake</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>LUC emissions</td>
<td>PgC / year</td>
<td><code>D_LUC_EMISSIONS</code></td>
<td><code><a href="../reference/carboncycle.html">LUC_EMISSIONS()</a></code></td>
<td><code>lucEmissions</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Atmospheric CO2 constraint</td>
<td>ppmv CO<sub>2</sub>
</td>
<td><code>D_CO2_CONSTRAIN</code></td>
<td></td>
<td><code>CO2_constrain</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="even">
<td>CO<sub>2</sub> fertilization factor</td>
<td>unitless</td>
<td><code>D_BETA</code></td>
<td><code><a href="../reference/parameters.html">BETA()</a></code></td>
<td><code>beta</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Biome warming multiplier</td>
<td>unitless</td>
<td><code>D_WARMINGFACTOR</code></td>
<td></td>
<td><code>warmingfactor</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>RH temperature sensitivity</td>
<td>unitless</td>
<td><code>D_Q10_RH</code></td>
<td><code><a href="../reference/parameters.html">Q10_RH()</a></code></td>
<td><code>q10_rh</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="other-routines">Other routines<a class="anchor" aria-label="anchor" href="#other-routines"></a>
</h2>
<ul>
<li>
<code>init()</code> – Initialize the C cycle model
<ul>
<li>Set initial values for the default biome (<code>"global"</code>) for
the following variables:
<ul>
<li>
<code>co2fert</code> (CO<sub>2</sub> fertilization multiplier) –
1.0</li>
<li>
<code>warmingfactor</code> (biome warming multiplier relative to
global average) – 1.0</li>
<li>
<code>residual</code> (difference between modeled atmospheric
CO<sub>2</sub> and constraint) – 0</li>
<li>
<code>tempfertd</code>, <code>tempferts</code> (Q10 warming effects
on detritus and soil respiration, respectively) – 1.0</li>
</ul>
</li>
<li>Add <code>"global"</code> to the biome list</li>
<li>Register C cycle model capabilities, dependencies, and inputs</li>
</ul>
</li>
<li>
<code>reset(time)</code> – Resets the state of the C model to time
<code>time</code>.
<ul>
<li>Set the values of all current-time state variables
(e.g. <code>atmos_co2</code>, <code>veg_c</code>,
<code>tempfertd</code>) to their time-series values at time
<code>time</code> (e.g. <code>atmos_c_ts.get(time)</code>,
<code>veg_c_tv.get(time)</code>,
<code>tempfertd_tv.get(time)</code>)</li>
<li>Re-calculate the CO<sub>2</sub> fertilization effect for each biome
(<code>co2fert</code>). If in spinup, force this to 1.0.</li>
<li>“Truncate” all time series variables up to the current time;
i.e. <code>erase</code> all of the values after <code>time</code>
</li>
<li>Set <code>tcurrent</code> to <code>time</code>
</li>
</ul>
</li>
<li>
<code>sanitychecks()</code> – Ensures the validity of the current
model state. Specific checks are:
<ul>
<li>All pools and fluxes (for each biome) must be greater than or equal
to 0</li>
<li>Partitioning fraction parameters (e.g. <code>f_nppv</code>,
<code>f_litterd</code>) must be between 0 and 1, and must sum to 1</li>
</ul>
</li>
<li>
<code>prepareToRun()</code> – Perform final checks and variable
initialization before running a simulation
<ul>
<li>Check that all biome-specific pools, fluxes, and parameters have
data for all biomes. (The only optional biome-specific parameter is
<code>warmingfactor</code>, which is set to 1.0 if missing). Also check
that biome-specific CO<sub>2</sub> fertilization (<code>beta</code>) and
Q10 (<code>q10_rh</code>) parameters are valid.</li>
<li>If no albedo forcing data are provided, set the value to the MAGICC
default of -0.2</li>
<li>Initialize the atmospheric CO<sub>2</sub> concentration
(<code>CO2_concentrations</code>, ppm) and C pool
(<code>atmos_co2</code>, PgC) to the user-specified initial value
(<code>C0</code>; converted accordingly to PgC for
<code>CO2_concentrations</code>)</li>
<li>Run the checks in <code>sanitychecks()</code>
</li>
</ul>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kalyn Dorheim, Ben Bond-Lamberty.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
