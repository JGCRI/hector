<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Installing and building Hector • hector</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Installing and building Hector">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hector</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/manual.html">Manual</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-getting-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Getting Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-getting-started">
<li><a class="dropdown-item" href="../articles/BuildHector.html">Building Hector</a></li>
    <li><a class="dropdown-item" href="../articles/hector.html">Intro to Hector R interface</a></li>
    <li><a class="dropdown-item" href="../articles/Hector-Wider-World.html">Documentation manuscripts &amp; tutorials</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/hector.html">Example: Basic run and simple sensitivity anlaysis</a></li>
    <li><a class="dropdown-item" href="../articles/ex_hector_apply.html">Example: Using Hector to solve for an emissions pathway</a></li>
    <li><a class="dropdown-item" href="../articles/ex_multiple-biomes.html">Example: Running Hector with multiple biomes</a></li>
    <li><a class="dropdown-item" href="../articles/ex_carbon_tracking.html">Example: Carbon tracking with Hector</a></li>
    <li><a class="dropdown-item" href="../articles/ex_land_ocean_warming.html">Example: Changing Hector's land ocean warming ratio parameter</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JGCRI/hector"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Installing and building Hector</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JGCRI/hector/blob/main/vignettes/articles/BuildHector.Rmd" class="external-link"><code>vignettes/articles/BuildHector.Rmd</code></a></small>
      <div class="d-none name"><code>BuildHector.Rmd</code></div>
    </div>

    
    
<p>There are many ways to use Hector: as a stand-alone executable,
through the online <a href="https://jgcri.shinyapps.io/HectorUI/" class="external-link">HectorUI</a>, and as an R
package. Here we provide installation and building instructions for the
R Hector package and the executable.</p>
<div class="section level2">
<h2 id="r-hector">R Hector<a class="anchor" aria-label="anchor" href="#r-hector"></a>
</h2>
<p>To install R, follow the <a href="https://cloud.r-project.org/" class="external-link">official instructions</a> for your
platform.</p>
<p>Follow this <a href="https://www.youtube.com/watch?v=Pg3WY8wg1cY" class="external-link">YouTube video</a> or
continue reading.</p>
<p>To install the version associated with the current <code>main</code>
git branch on GitHub, use the <code>remotes</code>::install_github`
function. This will automatically install all of Hector’s dependencies
as well. (Note that because this requires compiling from source, you
will need to have a C compiler installed and configured.)</p>
<p>On <strong>Windows</strong>, you will also need to install Rtools.
Download and instructions can be found <a href="https://cloud.r-project.org/bin/windows/Rtools/" class="external-link">here</a>. After
installation, there is another step to put the Rtools
<code>make utilities</code> on the system PATH. This will allow you to
compile R packages.</p>
<p>To do so, create a text file <code>.Renviron</code> in your Documents
folder with the following line:
<code>PATH="${RTOOLS40_HOME}\usr\bin;${PATH}"</code>.</p>
<p>This can be done either with a text editor or in R itself:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="st">'PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"'</span>, con <span class="op">=</span> <span class="st">"~/.Renviron"</span><span class="op">)</span></span></code></pre></div>
<p>Remember to restart R (or Rstudio) and to verify that
<code>make</code> can be found. Executing <code>Sys.which("make")</code>
should show the path to your Rtools installation.</p>
<p>On <strong>Mac OS</strong> and <strong>Linux</strong>, the required
tools should be included as part of a standard R installation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If the `remotes` package isn't installed, first run:</span></span>
<span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jgcri/hector"</span><span class="op">)</span></span></code></pre></div>
<p>Hector’s mandatory dependencies are listed in the
<code>DESCRIPTION</code> file under <code>Imports</code>, and are
currently as follows:</p>
<ul>
<li>
<a href="http://www.rcpp.org/" class="external-link"><code>Rcpp</code></a> – Facilitates
integration of C++ code into R packages</li>
<li>
<a href="https://cran.r-project.org/web/packages/BH/index.html" class="external-link"><code>BH</code></a>
– Boost C++ header files</li>
</ul>
</div>
<div class="section level2">
<h2 id="standalone-executable">Standalone Executable<a class="anchor" aria-label="anchor" href="#standalone-executable"></a>
</h2>
<p>Hector can also be compiled as a standalone executable. Unlike the R
package, this method of installation does not automatically pull in
dependencies, so you will have to install them manually.</p>
<p>Hector’s only external dependency, <strong>Boost</strong>, is a free,
peer-reviewed portable C++ source library, available at <a href="http://www.boost.org/" class="external-link uri">http://www.boost.org/</a>.
Hector primarily uses Boost “header-only” libraries, which do not need
to be compiled independently and only need to be extracted and included
with the Hector source. Note that if your C++ compiler or standard
library does <a href="#no-stdfilesystem-support">not support the C++ 17
standard</a> then the Boost <code>system</code> and
<code>filesystem</code> libraries will need to be compiled/installed
(see below).</p>
<div class="section level3">
<h3 id="command-line-linux-mac-osx">Command Line (Linux &amp; Mac OSX)<a class="anchor" aria-label="anchor" href="#command-line-linux-mac-osx"></a>
</h3>
<p>The Hector makefiles look for Boost libraries and headers in certain
locations; these defaults can be overridden by setting the following
environment variables:</p>
<ul>
<li>
<code>BOOSTROOT</code> (default <code>/usr/local/</code>). This
variable should contain the full name of a directory with
<code>include/</code> and <code>lib/</code> subdirectories that contain,
respectively, the Boost header and library files. If you installed Boost
using a package manager, this is likely where it is. If you built Boost
from source or used a tool such as <a href="https://brew.sh/" class="external-link">Homebrew</a> to install Boost, then you will
need to set this variable explicitly.</li>
</ul>
<p>Alternatively, if the header and library locations are not
subdirectories of a single directory, you can set <code>BOOSTINC</code>
and <code>BOOSTLIB</code> variables to their respective locations. In
this case, <code>BOOSTROOT</code> is ignored.</p>
<ul>
<li>
<code>GTROOT</code> (default <code>/usr/local/</code>). This
variable should contain the full name of a directory with
<code>include/</code> and <code>lib/</code> subdirectories that contain,
respectively, the Googletest header and library files. Alternatively, if
the header and library locations are not subdirectories of a single
directory, you can set <code>GTINC</code> and <code>GTLIB</code>
variables to their locations. In this case, <code>GTROOT</code> is
ignored. <strong>Note that this is only needed if you want to run the
Hector unit tests.</strong> It’s not needed for running the model.</li>
</ul>
<p><strong>Shared Library Search Path</strong></p>
<p>If your C++ compiler or standard library does not support the C++ 17
standard (see below), then the Boost libraries used by Hector will be
compiled into shared libraries that must be loaded at run time. It is
best if these libraries are in directories that are part of your
system’s shared library search path. On many systems
<code>/usr/local</code> is already in that path.</p>
<p>If you are unable to add your library installation directory to the
library search path, you will need to add the installation directory to
the environment variable <code>LD_LIBRARY_PATH</code>. Try not to use
this approach if you can help it, because it can cause some conflicts
with other software on your system. Instead, ask your system
administrator if <code>ldconfig</code> is right for you.</p>
<div class="section level4">
<h4 id="build-run-hector">Build &amp; Run Hector<a class="anchor" aria-label="anchor" href="#build-run-hector"></a>
</h4>
<p>Once the necessary libraries are installed, change to the top-level
Hector directory and type <code>make hector</code>. The Hector
executable will be built in the <code>source/</code> subdirectory. If
you ever need to rebuild, you can type <code>make clean</code> to clear
away the executable and all of the intermediate files.</p>
<p>There are two additional environment variables that you can use to
fine-tune the build process. The <code>CXXEXTRA</code> variable is
passed to the C++ compiler. You can use this variable to pass extra
options to the compiler without changing the Makefile. In particular,
specifying optimization options in <code>CXXEXTRA</code> such as -O or
-O0 will override the default value of -O3.</p>
<p>The <code>CXXPROF</code> variable is passed both to the compiler and
the linker. It is intended to turn on performance profiling, which must
be specified at both the compile and link stages of the build, so it
generally should be either unset (for normal operation) or set to -pg
(for profiling). Profiling slows the code down dramatically, so if you
use it, be sure to unset <code>CXXPROF</code>, clean the build
directories with <code>make clean</code>, and rebuild when you are ready
to go back to production runs.</p>
<div class="section level5">
<h5 id="no-stdfilesystem-support">No std::filesystem Support<a class="anchor" aria-label="anchor" href="#no-stdfilesystem-support"></a>
</h5>
<p>If your C++ compiler or standard library is too old, it will not
support the C++ 17 <code>std::filesystem</code>. In this case you may
receive errors while building Hector such as the following:</p>
<pre><code>g++  -L.  -o hector main.o -lhector -lm 
./libhector.a(ini_to_core_reader.o): In function `boost::filesystem::exists(boost::filesystem::path const&amp;)':
/pic/projects/GCAM/GCAM-libraries/include/boost/filesystem/operations.hpp:404: undefined reference to `boost::filesystem::detail::status(boost::filesystem::path const&amp;, boost::system::error_code*)'</code></pre>
<p>Or on versions of macOS prior to Catalina (10.15):</p>
<pre><code>ini_to_core_reader.cpp:159:17: error: 'path' is unavailable: introduced in macOS
      10.15
            fs::path csvFilePath( csvFileName );
                ^</code></pre>
<p>In this case, you can set an environment variable:</p>
<pre><code>export NO_CXX17=1</code></pre>
<p>and will need to <a href="https://www.boost.org/doc/libs/1_77_0/more/getting_started/unix-variants.html" class="external-link">Compile
Boost Libraries</a> – specifically, the <code>system</code> and
<code>filesystem</code> libraries. Finally, ensure that the environment
variable <code>BOOSTROOT</code> or <code>BOOSTLIB</code> is set properly
(see above).</p>
</div>
<div class="section level5">
<h5 id="running-hector">Running Hector<a class="anchor" aria-label="anchor" href="#running-hector"></a>
</h5>
<p>Run Hector from the terminal:</p>
<pre><code>./src/hector ./inst/input/name-of-ini.ini</code></pre>
<p>To build and run the Hector unit tests, type
<code>make testing</code> and then</p>
<pre><code><span><span class="va">.</span><span class="op">/</span><span class="va">src</span><span class="op">/</span><span class="va">unit</span><span class="op">-</span><span class="va">testing</span><span class="op">/</span><span class="va">hector</span><span class="op">-</span><span class="va">unit</span><span class="op">-</span><span class="va">tests</span></span></code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="xcode-mac-os-x">Xcode (Mac OS X)<a class="anchor" aria-label="anchor" href="#xcode-mac-os-x"></a>
</h3>
<p>These directions assume a basic familiarity with Xcode and Mac OS X
software installation.</p>
<ul>
<li>Install <a href="https://developer.apple.com/xcode/downloads/" class="external-link">Xcode</a> if
necessary. Hector has been built and tested with MacOS &gt;= 10.8.5, up
to Monterey (12.6.1). The project files are for Xcode 14.1.</li>
<li>Download and install Boost, following the instructions above.</li>
<li>Download the <a href="https://github.com/JGCRI/hector/archive/master.zip" class="external-link">Hector zip
file</a> or check out the repository using Git.</li>
<li>From Xcode, open the project file in
<code>project_files/Xcode/hector.xcodeproj</code>.</li>
</ul>
<p>The Xcode project file is configured to use constants defining custom
paths, rather than hard-coded paths. This means that developers and
users can set these paths without overwriting each other.</p>
<ul>
<li>As a result, <strong>you will need to set several custom
paths</strong> (Preferences -&gt; Locations -&gt; Custom Paths):
<code>BOOSTROOT</code>, and <code>HECTORDIR</code>.
<ul>
<li>
<code>BOOSTROOT</code> is the root directory where the Boost headers
can be found in <code>boost/</code>.<br>
</li>
<li>
<code>HECTORDIR</code> should be set to root directory for the model
(the repository root) Xcode will use this path to the ini files used by
the various schemes and write the csv files to the output
directory.</li>
</ul>
</li>
<li>If you want to build Hector’s testing framework (the
<code>hector-tests</code> target; this is optional and only relevant for
C++ developers) add GTEST and GTESTLIB custom paths to Xcode; these are
analogous to their Boost counterparts. You will need to install <a href="https://github.com/google/googletest" class="external-link">googletest</a> on your
machine.</li>
</ul>
<p>At this point you should be ready to go:</p>
<ul>
<li>Build the project, making sure you’re building the
<code>hector</code> target.</li>
<li>Run!</li>
<li>To run a different scenario, change the current Scheme settings
(Scheme-&gt;Edit Scheme) and modify or add a command-line argument
(<em>Arguments</em> tab, e.g. “./inst/input/hector_ssp245.ini”).</li>
</ul>
<p>The Xcode profile file includes a <code>hector-tests</code> target
that builds the unit testing framework described above.</p>
<p>Xcode Resources</p>
<ul>
<li><a href="https://developer.apple.com/library/archive/documentation/ToolsLanguages/Conceptual/Xcode_Overview/ManagingSchemes.html" class="external-link">Xcode
Schemes</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/debugging_with_xcode/chapters/debugging_tools.html" class="external-link">Xcode
Debugging</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="visual-studio-microsoft-visual-c">Visual Studio / Microsoft Visual C++<a class="anchor" aria-label="anchor" href="#visual-studio-microsoft-visual-c"></a>
</h3>
<ul>
<li>Install <a href="https://visualstudio.microsoft.com/vs/community/" class="external-link">Visual
Studio</a> and be sure to the Visual C++ add-on as well.</li>
<li>Download and install <a href="https://www.boost.org" class="external-link">Boost</a>.</li>
<li>Set the environment variables:
<ul>
<li>
<code>BOOSTROOT</code> to the location to which you installed Boost
(e.g. <code>C:\boost_1_75_0</code>)</li>
</ul>
</li>
<li>Open the Visual Studio project file which is located in your Hector
repository under <code>project_files/VS/hector.sln</code>
</li>
<li>Build the <code>hector</code> target</li>
<li>To run Hector:
<ul>
<li>From the CMD prompt:
<code>project_files/VS/x64/Release/hector.exe ./inst/input/name-of-ini.ini</code>
</li>
<li>From with in the Visual Studio debugger (the working directory will
default to <code>project_files/VS</code>):
<code>x64/Release/hector.exe ../../inst/input/name-of-ini.ini</code>
</li>
</ul>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kalyn Dorheim, Ben Bond-Lamberty.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
