<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Terrestrial C cycle • hector</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Terrestrial C cycle">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">hector</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/manual/index.html">Manual</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/intro-to-hector.html">A tour of the Hector R interface</a>
    </li>
    <li>
      <a href="../../articles/hector_apply.html">Example: Using Hector to solve for an emissions pathway</a>
    </li>
    <li>
      <a href="../../articles/multiple-biomes.html">Example: Running Hector with multiple biomes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JGCRI/hector">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Terrestrial C cycle</h1>
            
      
      
      <div class="hidden name"><code>SimpleNBox.Rmd</code></div>

    </div>

    
    
<p>Contents:</p>
<ul>
<li>
<a href="#simplenbox-science">Scientific basis</a> behind the terrestrial C cycle</li>
<li><a href="#simplenbox-implementation">Implementation details</a></li>
</ul>
<div id="simplenbox-science" class="section level1">
<h1 class="hasAnchor">
<a href="#simplenbox-science" class="anchor"></a>Science</h1>
<p>Hector’s land C sink is divided into three pools: vegetation (<span class="math inline">\(C_v\)</span>), detritus (<span class="math inline">\(C_d\)</span>), and soil (<span class="math inline">\(C_s\)</span>). These sinks are global by default, but they can be divided into <span class="math inline">\(n\)</span> “biomes” with unique parameters and initial pool sizes.</p>
<p>The total C flux from atmosphere to land at time <span class="math inline">\(t\)</span> (<span class="math inline">\(F_{L}(t)\)</span>) is the net of C sequestration by photosynthesis (net primary productivity, <span class="math inline">\(NPP_i(t)\)</span>) and C release by heterotrophic respiration (<span class="math inline">\(RH_i(t)\)</span>) summed across each biome <span class="math inline">\(i\)</span>, and global land use change (<span class="math inline">\(LUC(t)\)</span>):</p>
<p><span class="math display">\[ F_{L}(t) = \sum_{i=1}^{n} \left( NPP_i(t) - RH_i(t) \right) - LUC(t)  \]</span></p>
<p>NPP is calculated as the product of a user-specified pre-industrial value (<span class="math inline">\(NPP_0\)</span>, default is 50 PgC/year) and a CO<sub>2</sub> fertilization multiplier (<span class="math inline">\(f(C_{atm}, \beta)\)</span>), which in turn is a function of the current atmospheric CO<sub>2</sub> concentration (<span class="math inline">\(C_{atm}\)</span>), the initial (“pre-industrial”) CO<sub>2</sub> concentration (<span class="math inline">\(C_0\)</span>), and biome-specific CO<sub>2</sub> fertilization parameter <span class="math inline">\(\beta_i\)</span> (default = 0.36):</p>
<p><span class="math display">\[ NPP_i(t) = NPP_{0,i} \times f(C_{atm}, \beta_i) \]</span> <span class="math display">\[ f(C_{atm}, \beta_i) = 1 + \beta_i \left( \log(\frac{C_{atm}}{C_0})\right) \]</span></p>
<p>Heterotrophic respiration occurs in soil (<span class="math inline">\(RH_s(t)\)</span>) and detritus (<span class="math inline">\(RH_d(t))\)</span>) as a function of biome-specific atmospheric temperature anomaly (<span class="math inline">\(T_i\)</span>, calculated as the global atmospheric temperature anomaly scaled by a biome-specific warming factor <span class="math inline">\(\delta\)</span>) and the size of the current soil and detritus C pools (<span class="math inline">\(C_s\)</span> and <span class="math inline">\(C_d\)</span>, respectively).</p>
<p><span class="math display">\[ T_i(t) = \delta \, T_G(t) \]</span> <span class="math display">\[ RH_s = \frac{1}{50} C_s Q_{10}^{T_{i}(t) / 10}\]</span> <span class="math display">\[ RH_d = \frac{1}{4} C_d Q_{10}^{T_{i}(t) / 10}\]</span></p>
<p>Note that the residence times of soil and detritus C pools—50 and 4 years, respectively—are currently hard-coded values in Hector.</p>
<p>Fluxes associated with land use change (<span class="math inline">\(LUC\)</span>) are prescribed via the <code>luc_emissions</code> variable in the INI value. Example time series associated with representative carbon pathways (RCP) 2.6, 4.5, 6.0, and 8.5 are included with Hector in the corresponding <code>inst/input/emissions/RCP**_emissions.csv</code> files.</p>
<p>In each biome at each time step, the vegetation pools change as follows (biome, <span class="math inline">\(i\)</span> and time, <span class="math inline">\(t\)</span> subscripts omitted for clarity): C gain from NPP is distributed to vegetation, detritus, and soil according to fractionation parameters <span class="math inline">\(f_{nv}\)</span>, <span class="math inline">\(f_{nd}\)</span>, and <span class="math inline">\(f_{ns}\)</span>, respectively. Similarly, each pool bears a fraction of the total C loss from land-use change (<span class="math inline">\(F_{LC}\)</span>), again according to fractions <span class="math inline">\(f_{lv}\)</span>, <span class="math inline">\(f_{ld}\)</span>, and <span class="math inline">\(f_{ls}\)</span>. The detritus and soil pools also lose C via heterotrophic respiration (<span class="math inline">\(RH_d\)</span> and <span class="math inline">\(RH_s\)</span>, respectively). Finally, a fixed fraction of vegetation C is transferred to detritus as litterfall (<span class="math inline">\(f_{vd}\)</span>), and a fraction of both vegetation (<span class="math inline">\(f_{vs}\)</span>) and detritus (<span class="math inline">\(f_{ds}\)</span>) C are transferred to soil.</p>
<p><span class="math display">\[ \frac{dC_v}{dt} = NPP\, f_{nv} - C_v (f_{vd} + f_{vs}) - F_{LC} f_{lv} \]</span> <span class="math display">\[ \frac{dC_d}{dt} = NPP\, f_{nd} + C_v f_{vd} - C_d f_{ds} - RH_d - F_{LC} f_{ld} \]</span> <span class="math display">\[ \frac{dC_s}{dt} = NPP\, f_{ns} + C_v f_{vs} - C_d f_{ds} - RH_s - F_{LC} f_{ls} \]</span></p>
<p>The entire terrestrial C cycle is summarized in the following diagram:</p>
<div class="figure">
<img src="hector_terrestrial_c.svg" alt="Summary of terrestrial C cycle in Hector. The full Hector C cycle also includes ocean and “Earth” C pools that exchange C with the atmosphere, but these are omitted for clarity."><p class="caption">Summary of terrestrial C cycle in Hector. The full Hector C cycle also includes ocean and “Earth” C pools that exchange C with the atmosphere, but these are omitted for clarity.</p>
</div>
</div>
<div id="simplenbox-implementation" class="section level1">
<h1 class="hasAnchor">
<a href="#simplenbox-implementation" class="anchor"></a>Implementation</h1>
<p>The state of the global C cycle in Hector is defined by a length 6 vector <code>c</code>, which describes the amount of C (in Pg C) in the atmosphere (0), vegetation (1), detritus (2), soil (3), ocean (4), and “Earth” (5) at the current time step. At each Hector time step, <code>c</code> is solved by the <code>CarbonCycleSolver::run()</code> function (defined in <a href="https://github.com/JGCRI/hector/blob/master/src/carbon-cycle-solver.cpp"><code>src/carbon-cycle-solver.cpp</code></a>) in the following general steps:</p>
<ol style="list-style-type: decimal">
<li>Retrieve the current estimates of various pools from variables defined by the C cycle model and assign them to the relevant parts of <code>c</code> (<code>getCValues</code>).</li>
<li>Integrate from the beginning of the time step using updated slow parameters (<code>slowparameval</code>).</li>
<li>Solve the ordinary differential equations associated with the C cycle model based on its time derivatives (defined in <code>calcderivs</code>).</li>
<li>Re-calculate C cycle model internal variables based on the solved values of <code>c</code> (<code>stashCValues</code>).</li>
<li>Record the model state (<code>record_state</code>).</li>
</ol>
<p>These steps are described in more detail below. The complete code for the terrestrial C cycle lives in <a href="https://github.com/jgcri/hector/blob/master/src/simpleNbox.cpp"><code>src/simpleNbox.cpp</code></a> file (with associated headers in <a href="https://github.com/JGCRI/hector/blob/master/inst/include/simpleNbox.hpp"><code>inst/include/simpleNbox.hpp</code></a>).</p>
<div id="setting-the-c-vector-getcvalues" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-the-c-vector-getcvalues" class="anchor"></a>Setting the <code>c</code> vector (<code>getCValues</code>)</h2>
<p>This function sets the values of the <code>c</code> vector to the corresponding state variables in the C cycle model.</p>
<ul>
<li><p>The atmospheric C pool for the current time step is defined by <code>atmos_c</code>, which is always a scalar unit quantity (because CO<sub>2</sub> is assumed to be well-mixed in the atmosphere).</p></li>
<li><p>Vegetation, detritus, and soil pools at the current time step are stored in <code>veg_c</code>, <code>detritus_c</code>, and <code>soil_c</code>, respectively. These are vector quantities (“stringmaps”), with one value for each biome (the default biome name is “global”), so the value stored in the corresponding slot in <code>c</code> is the sum across all biomes. The ocean C pool is retrieved by a call to the current ocean model’s <code>getCValues</code> function. (NOTE: This means that <code>simpleNBox</code> model depends on the existence of an ocean C cycle model.)</p></li>
<li><p>Finally, the “Earth” C pool is stored in <code>earth_c</code>, which is also a scalar unit quantity.</p></li>
</ul>
<p>All of these variables have are in units Pg C.</p>
</div>
<div id="slow-parameter-evaluation-slowparameval" class="section level2">
<h2 class="hasAnchor">
<a href="#slow-parameter-evaluation-slowparameval" class="anchor"></a>Slow parameter evaluation (<code>slowparameval</code>)</h2>
<ul>
<li><p>Perform the ocean C model’s slow parameter evaluation (<code>omodel-&gt;slowparameval</code>)</p></li>
<li>Calculate CO<sub>2</sub> fertilization effect for each biome (<code>co2fert[biome]</code>) using the function <code>calc_co2fert</code>
<ul>
<li>…unless you are in the spin-up phase, in which case assume no effect (<code>co2fert = 1</code>)</li>
</ul>
</li>
<li>Calculate temperature effect on respiration of detritus (<code>tempfertd</code>) and soil (<code>tempferts</code>).
<ul>
<li>Note that soil warming is “sticky” – it can only increase, not decline (even if the temperature declines between time steps)</li>
<li>Note also that while detritus warming is based on the actual current biome temperature, the soil warming is based on a 200-year running mean</li>
</ul>
</li>
</ul>
<p>Note that these effect parameters are calculated but not yet applied. They will be applied to the actual NPP and RH estimates during the ODE solving loop.</p>
</div>
<div id="c-cycle-derivatives-calcderivs" class="section level2">
<h2 class="hasAnchor">
<a href="#c-cycle-derivatives-calcderivs" class="anchor"></a>C cycle derivatives (<code>calcderivs</code>)</h2>
<ul>
<li>Calculate NPP for each biome (<code>npp</code> function)</li>
<li>Partition NPP C gain into vegetation, detritus, and soil pools according to fractions</li>
<li>Calculate RH for detritus and soil</li>
<li>Partition C losses from RH accirding to fractions</li>
<li>Calculate and partition litter flux</li>
<li>Store changes in pools in <code>dcdt</code> vector (same structure as <code>c</code>)</li>
</ul>
</div>
<div id="storing-the-results-stashcvalues" class="section level2">
<h2 class="hasAnchor">
<a href="#storing-the-results-stashcvalues" class="anchor"></a>Storing the results (<code>stashCValues</code>)</h2>
<ul>
<li>Reset the atmospheric CO<sub>2</sub> state variable (<code>atmos_c</code>) to the current value from <code>c</code>
</li>
<li>Calculate the difference between vegetation, detritus, and soil C calculated by the ODE solver (i.e. in <code>c</code>) and what was stored in the current state variables (<code>veg_c</code>, <code>detritus_c</code>, <code>soil_c</code>). Store these differences in <code>veg_delta</code>, <code>det_delta</code>, <code>soil_delta</code>.</li>
<li>Apply these additional fluxes to each biome, weighing by the biome’s current gross primary productivity (<code>NPP + RH</code>). I.e.:
<ul>
<li>Calculate the total GPP across all biomes (<code>npp_rh_total = sum_npp() + sum_rh()</code>)</li>
<li>Calculate each biome’s weight (<code>wt[biome] = (npp(biome) + rh(biome)) / npp_rh_total</code>)</li>
<li>Add the corresponding difference multiplied by the weight to the biome’s current pool (e.g. <code>veg_c[biome] = veg_c[biome] + veg_delta * wt[biome]</code>)</li>
<li>NOTE: This is a workaround. In the future, Hector will use the ODE solver to separately solve all of the boxes in the multi-biome system.</li>
</ul>
</li>
<li>Stash the ocean C pools using the <code>omodel-&gt;stashCValues</code> function</li>
<li>Stash the Earth C pool (<code>earth_c</code>)</li>
<li>Check for mass conservation by take the sum of <code>c</code> (total C in system) and comparing it against the sum from the previous timestep (<code>masstot</code>).
<ul>
<li>NOTE: This check is skipped the first time this function is evaluated, at which point <code>masstot</code> is initialized to the calculated sum.</li>
</ul>
</li>
<li>If Hector is running under atmospheric CO<sub>2</sub> constraint, re-calculate the atmospheric CO<sub>2</sub> pool to match the constraint and move any residual C to/from the deep ocean pool.</li>
</ul>
</div>
<div id="recording-the-state-record_state" class="section level2">
<h2 class="hasAnchor">
<a href="#recording-the-state-record_state" class="anchor"></a>Recording the state (<code>record_state</code>)</h2>
<p>This just sets the time-series versions of all of the C cycle state variables (e.g. <code>atmos_c_ts</code>, <code>veg_c_tv</code>, <code>detritus_c_tv</code>, <code>tempfertd_tv</code>) to their corresponding state variables at the current time step (e.g. <code>atmos_c</code>, <code>veg_c</code>, <code>detritus_c</code>, <code>tempfertd</code>).</p>
</div>
<div id="simplenbox-setdata" class="section level2">
<h2 class="hasAnchor">
<a href="#simplenbox-setdata" class="anchor"></a>Setting (<code>setData</code>) and retrieving (<code>getData</code>) values</h2>
<p>The following values related to the terrestrial C cycle can be set via <code>setData</code>.</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="7%">
<col width="18%">
<col width="14%">
<col width="11%">
<col width="7%">
<col width="10%">
<col width="3%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th>Description</th>
<th>Unit</th>
<th>C++ macro</th>
<th>R function</th>
<th>C++ variable</th>
<th>Needs date</th>
<th>Biome-specific</th>
<th>Set</th>
<th>Get</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Initial atmospheric CO<sub>2</sub> pool</td>
<td>PgC</td>
<td><code>D_ATMOSPHERIC_C</code></td>
<td><code><a href="../../reference/carboncycle.html">ATMOSPHERIC_C()</a></code></td>
<td><code>C0</code></td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Pre-industrial CO<sub>2</sub> concentration</td>
<td>ppmv CO<sub>2</sub>
</td>
<td><code>D_PREINDUSTRIAL_C02</code></td>
<td><code><a href="../../reference/parameters.html">PREINDUSTRIAL_CO2()</a></code></td>
<td><code>C0</code></td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Atmospheric C constraint residual</td>
<td>ppmv CO<sub>2</sub>
</td>
<td><code>D_ATMOSPHERIC_C_RESIDUAL</code></td>
<td></td>
<td><code>residual</code></td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Vegetation C pool</td>
<td>PgC</td>
<td><code>D_VEGC</code></td>
<td></td>
<td><code>veg_c</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Detritus C pool</td>
<td>PgC</td>
<td><code>D_DETRITUSC</code></td>
<td></td>
<td><code>detritus_c</code></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Soil C pool</td>
<td>PgC</td>
<td><code>D_SOILC</code></td>
<td></td>
<td><code>soil_c</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Radiative forcing from albedo</td>
<td>unitless</td>
<td><code>D_RF_T_ALBEDO</code></td>
<td><code><a href="../../reference/forcings.html">RF_T_ALBEDO()</a></code></td>
<td><code>Ftalbedo</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Frac. NPP to vegetation</td>
<td>unitless</td>
<td><code>D_F_NPPV</code></td>
<td><code><a href="../../reference/parameters.html">F_NPPV()</a></code></td>
<td><code>f_nppv</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Frac. NPP to detritus</td>
<td>unitless</td>
<td><code>D_F_NPPD</code></td>
<td><code><a href="../../reference/parameters.html">F_NPPD()</a></code></td>
<td><code>f_nppd</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Frac. veg. C to litter</td>
<td>unitless</td>
<td><code>D_F_LITTERD</code></td>
<td><code><a href="../../reference/parameters.html">F_LITTERD()</a></code></td>
<td><code>f_litterd</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Frac. LUC from vegetation</td>
<td>unitless</td>
<td><code>D_F_LUCV</code></td>
<td><code><a href="../../reference/parameters.html">F_LUCV()</a></code></td>
<td><code>f_lucv</code></td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Frac. LUC from detritus</td>
<td>unitless</td>
<td><code>D_F_LUCD</code></td>
<td><code><a href="../../reference/parameters.html">F_LUCD()</a></code></td>
<td><code>f_lucd</code></td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Initial NPP flux</td>
<td>PgC / year</td>
<td><code>D_NPP_FLUX0</code></td>
<td></td>
<td><code>npp_flux0</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Fossil fuel CO<sub>2</sub> emissions</td>
<td>PgC / year</td>
<td><code>D_FFI_EMISSIONS</code></td>
<td><code><a href="../../reference/carboncycle.html">FFI_EMISSIONS()</a></code></td>
<td><code>ffiEmissions</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>LUC emissions</td>
<td>PgC / year</td>
<td><code>D_LUC_EMISSIONS</code></td>
<td><code><a href="../../reference/carboncycle.html">LUC_EMISSIONS()</a></code></td>
<td><code>lucEmissions</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Atmospheric CO2 constraint</td>
<td>ppmv CO<sub>2</sub>
</td>
<td><code>D_CA_CONSTRAIN</code></td>
<td></td>
<td><code>Ca_constrain</code></td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="odd">
<td>CO<sub>2</sub> fertilization factor</td>
<td>unitless</td>
<td><code>D_BETA</code></td>
<td><code><a href="../../reference/parameters.html">BETA()</a></code></td>
<td><code>beta</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Biome warming multiplier</td>
<td>unitless</td>
<td><code>D_WARMINGFACTOR</code></td>
<td></td>
<td><code>warmingfactor</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>RH temperature sensitivity</td>
<td>unitless</td>
<td><code>D_Q10_RH</code></td>
<td><code><a href="../../reference/parameters.html">Q10_RH()</a></code></td>
<td><code>q10_rh</code></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div>
<div id="other-routines" class="section level2">
<h2 class="hasAnchor">
<a href="#other-routines" class="anchor"></a>Other routines</h2>
<ul>
<li>
<code>init()</code> – Initialize the C cycle model
<ul>
<li>Set inital values for the default biome (<code>"global"</code>) for the following variables:
<ul>
<li>
<code>co2fert</code> (CO<sub>2</sub> fertilization multiplier) – 1.0</li>
<li>
<code>warmingfactor</code> (biome warming multiplier relative to global average) – 1.0</li>
<li>
<code>residual</code> (difference between modeled atmospheric CO<sub>2</sub> and constraint) – 0</li>
<li>
<code>tempfertd</code>, <code>tempferts</code> (Q10 warming effects on detritus and soil respiration, respectively) – 1.0</li>
</ul>
</li>
<li>Add <code>"global"</code> to the biome list</li>
<li>Register C cycle model capabilities, dependencies, and inputs</li>
</ul>
</li>
<li>
<code><a href="../../reference/reset.html">reset(time)</a></code> – Resets the state of the C model to time <code>time</code>.
<ul>
<li>Set the values of all current-time state variables (e.g. <code>atmos_c</code>, <code>veg_c</code>, <code>tempfertd</code>) to their time-series values at time <code>time</code> (e.g. <code>atmos_c_ts.get(time)</code>, <code>veg_c_tv.get(time)</code>, <code>tempfertd_tv.get(time)</code>)</li>
<li>Re-calculate the CO<sub>2</sub> fertilization effect for each biome (<code>co2fert</code>). If in spinup, force this to 1.0.</li>
<li>“Truncate” all time series variables up to the current time; i.e. <code>erase</code> all of the values after <code>time</code>
</li>
<li>Set <code>tcurrent</code> to <code>time</code>
</li>
</ul>
</li>
<li>
<code>sanitychecks()</code> – Ensures the validity of the current model state. Specific checks are:
<ul>
<li>All pools and fluxes (for each biome) must be greater than or equal to 0</li>
<li>Partitioning fraction parameters (e.g. <code>f_nppv</code>, <code>f_litterd</code>) must be between 0 and 1, and must sum to 1</li>
</ul>
</li>
<li>
<code>prepareToRun()</code> – Perform final checks and variable initialization before running a simulation
<ul>
<li>Check that all biome-specific pools, fluxes, and parameters have data for all biomes. (The only optional biome-specific parameter is <code>warmingfactor</code>, which is set to 1.0 if missing). Also check that biome-specific CO<sub>2</sub> fertilization (<code>beta</code>) and Q10 (<code>q10_rh</code>) parameters are valid.</li>
<li>If no albedo forcing data are provided, set the value to the MAGICC default of -0.2</li>
<li>Initialize the atmosphic CO<sub>2</sub> concentration (<code>Ca</code>, ppm) and C pool (<code>atmos_c</code>, PgC) to the user-specified initial value (<code>C0</code>; converted accordingly to PgC for <code>atmos_c</code>)</li>
<li>Run the checks in <code>sanitychecks()</code>
</li>
</ul>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simplenbox-science">Science</a></li>
      <li>
<a href="#simplenbox-implementation">Implementation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#setting-the-c-vector-getcvalues">Setting the <code>c</code> vector (<code>getCValues</code>)</a></li>
      <li><a href="#slow-parameter-evaluation-slowparameval">Slow parameter evaluation (<code>slowparameval</code>)</a></li>
      <li><a href="#c-cycle-derivatives-calcderivs">C cycle derivatives (<code>calcderivs</code>)</a></li>
      <li><a href="#storing-the-results-stashcvalues">Storing the results (<code>stashCValues</code>)</a></li>
      <li><a href="#recording-the-state-record_state">Recording the state (<code>record_state</code>)</a></li>
      <li><a href="#simplenbox-setdata">Setting (<code>setData</code>) and retrieving (<code>getData</code>) values</a></li>
      <li><a href="#other-routines">Other routines</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert Link, Corinne Hartin, Ben Bond-Lamberty, Pralit Patel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
